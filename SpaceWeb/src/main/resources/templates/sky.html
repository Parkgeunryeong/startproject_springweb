<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<script src="/js/virtualsky.min.js?nocache=22"></script>


<style>
body {
	margin: 0;
	padding: 0;
}

#starmap1 {
	width: 100%;
	height: 800px;
}
#starmap2 {
	width: 100%;
	height: 800px;
}
</style>
</head>
<body>
	<h2>í˜„ì¬ íƒœì–‘ì˜ ìœ„ì¹˜</h2>
	<p id="info"> ìœ„ì¹˜ ì •ë³´ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
	<div id="starmap1"></div>

	<script>
    $(document).ready(function () {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(success, error);
      } else {
        $("#info").text(" ìœ„ì¹˜ ì •ë³´ ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
      }

      function success(position) {
        const lat = position.coords.latitude;
        const lon = position.coords.longitude;

        //  Flask API í˜¸ì¶œ
        fetch(`http://localhost:5000/api/jupiter?lat=${lat}&lon=${lon}`)
          .then(res => res.json())
          .then(data => {
            const ra = data.ra;
            const dec = data.dec;

            $("#info").html(` ìœ„ì¹˜: ${lat.toFixed(3)}, ${lon.toFixed(3)}<br>
             ì ê²½(RA): ${ra}ì‹œ, ì ìœ„(Dec): ${dec}ë„`);
            
         

            //  VirtualSky ì´ˆê¸°í™”
            const sky= $.virtualsky({
              id: "starmap1",
              lang: "en",
              projection: "gnomic",
              ground: false,
              latitude: lat,
              longitude: lon,
              clock: new Date(),
              constellations: true,
              constellationlabels: true,
              showstars: true,
              planets: false,
              planetlabels: false,
              showposition: false,
              gridlines_az: true,
              mouse: {
                drag: true,
                zoom: true,
                move: true
              }
            });
            setTimeout(() => {
            	sky.draw.planets = false;
            	
            	
                
            	
                sky.setClock(new Date());
                sky.times = sky.astronomicalTimes();  
                console.log("ğŸŒ VirtualSky ì„¤ì • í™•ì¸");
                console.log("ìœ„ë„:", sky.latitude);
                console.log("ê²½ë„:", sky.longitude);
                console.log("ì‹œê° (sky.clock):", sky.clock.toISOString());
                console.log("ì…ë ¥ëœ ì ê²½ (RA):", ra);
                console.log("ì…ë ¥ëœ ì ìœ„ (Dec):", dec);
                sky.addPointer({
                  ra: ra,
                  dec: dec,
                  label: "ìŠ¤ì¹´ì´ í•„ë“œë¡œ ê³„ì‚°í•œ íƒœì–‘",
                  colour: "red",
                  
                });
               
            	
              }, 2000); // VirtualSky ë Œë”ë§ ì™„ë£Œê¹Œì§€ ì•½ê°„ ëŒ€ê¸°
          });
      }

      function error() {
        $("#info").text(" ìœ„ì¹˜ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
      }
    });
  </script>
</body>
</html>